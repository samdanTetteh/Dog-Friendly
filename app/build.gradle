plugins {
    id 'com.android.application'
    id 'org.jetbrains.kotlin.android'
    id 'kotlin-kapt'
    id 'dagger.hilt.android.plugin'
    id 'androidx.navigation.safeargs.kotlin'
}

android {
    compileSdkVersion ConfigData.androidCompileSdk

    defaultConfig {
        applicationId "com.ijikod.dog_friendly"
        minSdkVersion ConfigData.androidMinSdk
        targetSdkVersion ConfigData.androidTargetSdk
        versionCode ConfigData.versionCode
        versionName ConfigData.versionName

        testInstrumentationRunner = "com.ijikod.com.ijikod.dog_friendly.CustomTestRunner"
    }

    buildTypes {
        release {
            minifyEnabled false
            proguardFiles getDefaultProguardFile('proguard-android-optimize.txt'), 'proguard-rules.pro'
        }
    }
    compileOptions {
        sourceCompatibility JavaVersion.VERSION_1_8
        targetCompatibility JavaVersion.VERSION_1_8
    }
    kotlinOptions {
        jvmTarget = '1.8'
    }
    packagingOptions {
        exclude 'LICENSE.txt'
        exclude 'META-INF/rxjava.properties'
        pickFirst 'META-INF/gradle/incremental.annotation.processors'
    }

    kapt {
        correctErrorTypes = true
    }

    buildFeatures {
        viewBinding = true
    }

    lintOptions {
        checkReleaseBuilds false
    }

    hilt {
        enableExperimentalClasspathAggregation = true
    }

    defaultConfig {
        javaCompileOptions {
            annotationProcessorOptions {
                arguments += [
                        "room.schemaLocation":"$projectDir/schemas".toString(),
                        "room.incremental":"true",
                        "room.expandProjection":"true"]
            }
        }
    }

    testOptions {
        execution 'ANDROIDX_TEST_ORCHESTRATOR'

        unitTests.all {
            useJUnitPlatform() // <--- this is the important part
        }
    }
}

kapt {
    arguments {
        // Make Hilt share the same definition of Components in tests instead of
        // creating a new set of Components per test class.
        arg("dagger.hilt.shareTestComponents", "true")
    }
}

dependencies {

    implementation project(path: ':domain')
    implementation project(path: ':data')
    implementation Libs.androidKtx
    implementation Libs.appCompat
    implementation Libs.materialDesign
    implementation Libs.constraintLayout
    implementation Libs.recyclerView
    implementation Libs.androidHilt
    implementation Libs.lifeCycle
    implementation 'androidx.test:runner:1.4.0'
    kaptAndroidTest Libs.hiltAndroidCompiler
    implementation Libs.retrofit
    implementation Libs.okHttp
    implementation Libs.gson
    implementation Libs.rxJava
    implementation Libs.rxRelay
    implementation Libs.rxAndroid
    implementation Libs.rxBindings
    implementation Libs.retrofitRxAdapter
    implementation Libs.navigationFragmentKtx
    implementation Libs.navigationUIKtx
    implementation Libs.fragment
    debugImplementation Libs.fragmentTesting
    androidTestImplementation Libs.navigationTesting
    implementation Libs.picasso
    testImplementation Libs.junit
    androidTestImplementation Libs.hiltTesting
    testImplementation Libs.robolecttic
    testImplementation 'org.junit.jupiter:junit-jupiter-engine:5.7.1'
    androidTestImplementation (Libs.espressoTestContrib){
        exclude group: 'com.android.support', module: 'appcompat'
        exclude module: 'recyclerview-v7'
        exclude module: 'appcompat-v7'
    }
    androidTestImplementation Libs.espressoTest
    androidTestImplementation Libs.androidJunitTest

}